var toggleBinaryGlobal="10000000000000000000000000000000000000000000000000000",thesparezeros="00000000000000000000000000",toggleState,courseid,thewwwroot,numToggles=0,currentSection,togglePersistence=1,mymobiletheme=false,ourYUI;M.format_topcoll=M.format_topcoll||{};M.format_topcoll.init=function(Y,wwwroot,thecourseid,thetogglestate,noOfToggles,theTogglePersistence){ourYUI=Y;thewwwroot=wwwroot;courseid=thecourseid;toggleState=thetogglestate;numToggles=noOfToggles;togglePersistence=theTogglePersistence;if(toggleState!=null){toggleBinaryGlobal=to2baseString(toggleState)}else toggleBinaryGlobal="10000000000000000000000000000000000000000000000000000";if(document.getElementById("mymobile"))mymobiletheme=true;for(var theToggle=1;theToggle<=numToggles;theToggle++){var toggler=document.getElementById("toggle-"+theToggle);if(toggler!=null){var instance=new CollapsedTopicsToggler(toggler,theToggle);Y.one("#toggle-"+theToggle).on('click',instance.handleClick,instance)}};var allopen=Y.one("#toggles-all-opened");if(allopen)allopen.on('click',function(e){e.preventDefault();all_opened()});var allclosed=Y.one("#toggles-all-closed");if(allclosed)allclosed.on('click',function(e){e.preventDefault();all_closed()})};var CollapsedTopicsToggler=function CollapsedTopicsToggler(toggler,toggleNum){this.toggler=toggler;this.toggleNum=toggleNum};CollapsedTopicsToggler.prototype={handleClick:function(e){e.preventDefault();toggle_topic(this.toggler,this.toggleNum)}}
function togglebinary(toggleNum,toggleVal,savetoggles){if((toggleNum>=1)&&(toggleNum<=52)){var start=toggleBinaryGlobal.substring(0,toggleNum),end=toggleBinaryGlobal.substring(toggleNum+1);toggleBinaryGlobal=start+toggleVal+end;if(savetoggles==true)save_toggles()}}
function toggleexacttopic(target,image,toggleNum,reloading,savetoggles){if(document.getElementById){var displaySetting="block";if(target.style.display==displaySetting){target.style.display="none";if(mymobiletheme==true){image.className=image.className.replace(/\b opencps\b/,'');image.className=image.className.replace('toggle_open','toggle_closed')}else image.className=image.className.replace('toggle_open','toggle_closed');if(reloading==false)togglebinary(toggleNum,"0",savetoggles)}else{target.style.display=displaySetting;if(mymobiletheme==true){image.className+=" opencps";image.className=image.className.replace('toggle_closed','toggle_open')}else image.className=image.className.replace('toggle_closed','toggle_open');if(reloading==false)togglebinary(toggleNum,"1",savetoggles)}}}
function toggle_topic(toggler,toggleNum){imageSwitch=toggler.firstChild;targetElement=toggler.nextSibling;toggleexacttopic(targetElement,imageSwitch,toggleNum,false,true)}
function to2baseString(thirtysix){var firstpart=parseInt(thirtysix.substring(0,6),36),secondpart=parseInt(thirtysix.substring(6,12),36),fps=firstpart.toString(2),sps=secondpart.toString(2);if(fps.length<26)fps=thesparezeros.substring(0,(26-fps.length))+fps;if(sps.length<27)sps=thesparezeros.substring(0,(27-sps.length))+sps;return fps+sps}
function to36baseString(two){var firstpart=parseInt(two.substring(0,26),2),secondpart=parseInt(two.substring(26,53),2),fps=firstpart.toString(36),sps=secondpart.toString(36);if(fps.length<6)fps=thesparezeros.substring(0,(6-fps.length))+fps;if(sps.length<6)sps=thesparezeros.substring(0,(6-sps.length))+sps;return fps+sps}
function save_toggles(){if(togglePersistence==1)M.util.set_user_preference('topcoll_toggle_'+courseid,to36baseString(toggleBinaryGlobal))}
function allToggle(state){var displaySetting;if(state==false){displaySetting="block"}else displaySetting="none";for(var theToggle=1;theToggle<=numToggles;theToggle++){var target=document.getElementById("toggledsection-"+theToggle),image=document.getElementById("toggle-"+theToggle);if((target!=null)&&(image!=null)){target.style.display=displaySetting;toggleexacttopic(target,image.firstChild,theToggle,false,false)}};save_toggles()}
function all_opened(){allToggle(true)}
function all_closed(){allToggle(false)}